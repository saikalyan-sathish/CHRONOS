@tailwind base;
@tailwind components;
@tailwind utilities;

:root {
  --foreground-rgb: 0, 0, 0;
  --background-start-rgb: 249, 250, 251;
  --background-end-rgb: 255, 255, 255;
}

.dark {
  --foreground-rgb: 255, 255, 255;
  --background-start-rgb: 15, 23, 42;
  --background-end-rgb: 30, 41, 59;
}

* {
  box-sizing: border-box;
  padding: 0;
  margin: 0;
}

html,
body {
  max-width: 100vw;
  overflow-x: hidden;
}

body {
  color: rgb(var(--foreground-rgb));
  background: transparent;
  min-height: 100vh;
}

/* 2026 Glassmorphism Utilities */
.glass-panel {
  @apply bg-white/70 dark:bg-dark-800/60 backdrop-blur-xl border border-white/20 dark:border-white/10 shadow-lg ring-1 ring-black/5;
}

.glass-card {
  @apply bg-white/60 dark:bg-dark-800/50 backdrop-blur-md border border-white/20 dark:border-white/5 transition-all duration-300 hover:bg-white/80 dark:hover:bg-dark-800/70 hover:shadow-xl hover:scale-[1.02];
}

.glass-button {
  @apply bg-white/20 hover:bg-white/30 dark:bg-white/10 dark:hover:bg-white/20 backdrop-blur-sm border border-white/10 transition-all active:scale-95;
}

.glow-text {
  text-shadow: 0 0 20px rgba(var(--primary-500-rgb), 0.5);
}

/* Scrollbar styling - Chrome, Safari, Edge */
::-webkit-scrollbar {
  width: 8px;
  height: 8px;
}

::-webkit-scrollbar-track {
  background: transparent;
}

::-webkit-scrollbar-thumb {
  background: #cbd5e1;
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: #94a3b8;
}

.dark ::-webkit-scrollbar-thumb {
  background: #475569;
}

.dark ::-webkit-scrollbar-thumb:hover {
  background: #64748b;
}

/* Firefox scrollbar styling */
* {
  scrollbar-width: thin;
  scrollbar-color: #cbd5e1 transparent;
}

.dark * {
  scrollbar-color: #475569 transparent;
}

/* Calendar styles */
.rbc-calendar {
  font-family: inherit;
}

.rbc-header {
  padding: 12px 8px;
  font-weight: 600;
  font-size: 0.875rem;
  border-bottom: 1px solid #e2e8f0;
}

.dark .rbc-header {
  border-color: #334155;
}

.rbc-today {
  background-color: rgba(59, 130, 246, 0.1);
}

.dark .rbc-today {
  background-color: rgba(59, 130, 246, 0.2);
}

.rbc-off-range-bg {
  background-color: #f8fafc;
}

.dark .rbc-off-range-bg {
  background-color: #1e293b;
}

.rbc-event {
  border-radius: 4px;
  padding: 2px 6px;
  font-size: 0.75rem;
  border: none;
  transition: transform 0.1s ease, box-shadow 0.1s ease;
}

.rbc-event:hover {
  transform: scale(1.02);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
}

.rbc-event-content {
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.rbc-day-slot .rbc-time-slot {
  border-top: 1px solid #f1f5f9;
}

.dark .rbc-day-slot .rbc-time-slot {
  border-color: #1e293b;
}

.rbc-time-view {
  border: 1px solid #e2e8f0;
  border-radius: 8px;
  overflow: hidden;
}

.dark .rbc-time-view {
  border-color: #334155;
}

.rbc-month-view {
  border: 1px solid #e2e8f0;
  border-radius: 8px;
  overflow: hidden;
}

.dark .rbc-month-view {
  border-color: #334155;
}

.rbc-date-cell {
  padding: 4px 8px;
  text-align: right;
  font-size: 0.875rem;
}

.rbc-date-cell.rbc-now {
  font-weight: bold;
}

.rbc-date-cell>a {
  color: inherit;
}

/* Animation classes - with reduced motion support */
.animate-in {
  animation: animateIn 0.3s ease-out forwards;
}

@keyframes animateIn {
  from {
    opacity: 0;
    transform: translateY(10px);
  }

  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* Respect user preference for reduced motion */
@media (prefers-reduced-motion: reduce) {

  .animate-in,
  .rbc-event,
  * {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }
}

/* Focus indicator */
.focus-ring {
  @apply focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2;
}

.dark .focus-ring {
  @apply focus:ring-offset-dark-900;
}

/* Button styles */
.btn {
  @apply inline-flex items-center justify-center px-4 py-2 text-sm font-medium rounded-lg transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2;
}

.btn-primary {
  @apply bg-primary-600 text-white hover:bg-primary-700 focus:ring-primary-500;
}

.btn-secondary {
  @apply bg-gray-100 text-gray-700 hover:bg-gray-200 focus:ring-gray-500;
}

.dark .btn-secondary {
  @apply bg-dark-700 text-dark-100 hover:bg-dark-600;
}

.btn-danger {
  @apply bg-red-600 text-white hover:bg-red-700 focus:ring-red-500;
}

.btn-ghost {
  @apply bg-transparent text-gray-600 hover:bg-gray-100 focus:ring-gray-500;
}

.dark .btn-ghost {
  @apply text-dark-300 hover:bg-dark-700;
}

/* Input styles */
.input {
  @apply w-full px-4 py-2 text-sm border border-gray-300 rounded-lg transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent;
}

.dark .input {
  @apply bg-dark-800 border-dark-600 text-dark-100 placeholder-dark-400;
}

/* Card styles */
.card {
  @apply bg-white rounded-xl shadow-soft p-6 transition-shadow duration-200;
}

.dark .card {
  @apply bg-dark-800 shadow-lg;
}

.card-hover:hover {
  @apply shadow-lg;
}

/* Glass effect - with Firefox optimization */
.glass {
  @apply bg-white/80;
  -webkit-backdrop-filter: blur(16px);
  backdrop-filter: blur(16px);
}

/* Fallback for browsers that don't support backdrop-filter */
@supports not (backdrop-filter: blur(16px)) {
  .glass {
    @apply bg-white/95;
  }

  .dark .glass {
    @apply bg-dark-800/95;
  }
}

.dark .glass {
  @apply bg-dark-800/80;
  -webkit-backdrop-filter: blur(16px);
  backdrop-filter: blur(16px);
}

/* Gradient backgrounds */
.gradient-primary {
  @apply bg-gradient-to-r from-primary-500 to-primary-600;
}

.gradient-dark {
  @apply bg-gradient-to-br from-dark-800 to-dark-900;
}

/* Priority colors */
.priority-low {
  @apply bg-green-100 text-green-800;
}

.dark .priority-low {
  @apply bg-green-900/30 text-green-400;
}

.priority-medium {
  @apply bg-yellow-100 text-yellow-800;
}

.dark .priority-medium {
  @apply bg-yellow-900/30 text-yellow-400;
}

.priority-high {
  @apply bg-orange-100 text-orange-800;
}

.dark .priority-high {
  @apply bg-orange-900/30 text-orange-400;
}

.priority-urgent {
  @apply bg-red-100 text-red-800;
}

.dark .priority-urgent {
  @apply bg-red-900/30 text-red-400;
}

/* Status colors */
.status-pending {
  @apply bg-gray-100 text-gray-800;
}

.dark .status-pending {
  @apply bg-gray-800 text-gray-300;
}

.status-in-progress {
  @apply bg-blue-100 text-blue-800;
}

.dark .status-in-progress {
  @apply bg-blue-900/30 text-blue-400;
}

.status-completed {
  @apply bg-green-100 text-green-800;
}

.dark .status-completed {
  @apply bg-green-900/30 text-green-400;
}

/* Focus timer ring */
.focus-timer-ring {
  stroke-dasharray: 283;
  stroke-dashoffset: 283;
  animation: focus-progress 1s ease-out forwards;
}

@keyframes focus-progress {
  to {
    stroke-dashoffset: var(--progress);
  }
}

/* Shimmer loading effect */
.shimmer {
  background: linear-gradient(90deg,
      #f0f0f0 25%,
      #e0e0e0 50%,
      #f0f0f0 75%);
  background-size: 200% 100%;
  animation: shimmer 1.5s infinite;
}

.dark .shimmer {
  background: linear-gradient(90deg,
      #334155 25%,
      #475569 50%,
      #334155 75%);
  background-size: 200% 100%;
}

/* Tooltip */
.tooltip {
  @apply invisible absolute z-50 px-2 py-1 text-xs text-white bg-gray-900 rounded opacity-0 transition-all duration-200;
}

.tooltip-trigger:hover .tooltip {
  @apply visible opacity-100;
}

/* Badge */
.badge {
  @apply inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium;
}

/* Notification dot */
.notification-dot {
  @apply absolute -top-1 -right-1 h-3 w-3 bg-red-500 rounded-full animate-pulse;
}

/* Drag and drop styles */
.dragging {
  @apply opacity-50 scale-105;
}

.drag-over {
  @apply ring-2 ring-primary-500 ring-offset-2;
}

/* ===========================================
   MOBILE RESPONSIVE STYLES
   =========================================== */

/* Touch-friendly tap targets */
@media (max-width: 768px) {

  .btn,
  button,
  [role="button"] {
    min-height: 44px;
    min-width: 44px;
  }

  /* Larger touch targets for inputs */
  .input,
  input,
  select,
  textarea {
    min-height: 44px;
    font-size: 16px;
    /* Prevents zoom on iOS */
  }

  /* Modal responsiveness - Bottom Sheet Style */
  [role="dialog"] .fixed.inset-0.overflow-y-auto {
    padding: 0;
    display: flex;
    align-items: flex-end;
  }

  [role="dialog"]>div>div {
    max-height: 85vh;
    margin: 0;
    width: 100% !important;
    max-width: 100% !important;
    border-radius: 20px 20px 0 0;
    padding-bottom: max(1rem, env(safe-area-inset-bottom));
    position: relative;
    /* Slide up animation is handled by Headless UI transition classes, 
       but we force positioning here */
  }

  /* Drag handle for bottom sheet */
  [role="dialog"]>div>div::after {
    content: '';
    position: absolute;
    top: 8px;
    left: 50%;
    transform: translateX(-50%);
    width: 40px;
    height: 4px;
    background-color: #e2e8f0;
    border-radius: 2px;
  }

  .dark [role="dialog"]>div>div::after {
    background-color: #475569;
  }

  /* Adjust modal header for drag handle */
  [role="dialog"] h3 {
    padding-top: 12px;
  }

  /* Sidebar handling */
  .sidebar-mobile-overlay {
    @apply fixed inset-0 bg-black/50 z-40;
  }

  /* Hide undo/redo toolbar on very small screens */
  .undo-redo-toolbar {
    @apply hidden sm:flex;
  }

  /* Calendar mobile adjustments */
  .rbc-calendar {
    font-size: 0.75rem;
  }

  .rbc-header {
    padding: 8px 4px;
    font-size: 0.75rem;
  }

  .rbc-event {
    padding: 2px 4px !important;
    font-size: 0.65rem !important;
  }

  .rbc-time-slot {
    min-height: 30px;
  }

  /* Stack form elements on mobile */
  .form-row,
  .grid-cols-2 {
    @apply grid-cols-1;
  }

  /* Full-width buttons on mobile */
  .btn-group-mobile {
    @apply flex flex-col gap-2;
  }

  .btn-group-mobile .btn {
    @apply w-full justify-center;
  }

  /* Padding adjustments for mobile */
  .p-6 {
    @apply p-4;
  }

  .p-8 {
    @apply p-4;
  }

  /* Card adjustments */
  .card {
    @apply rounded-xl;
  }
}

/* Small phones */
@media (max-width: 375px) {
  .rbc-event {
    font-size: 0.55rem !important;
  }

  .rbc-header {
    font-size: 0.65rem;
  }

  h1 {
    font-size: 1.5rem !important;
  }

  h2 {
    font-size: 1.25rem !important;
  }
}

/* Tablet adjustments */
@media (min-width: 769px) and (max-width: 1024px) {
  .sidebar-collapsed .main-content {
    margin-left: 80px;
  }
}

/* Safe area for notched phones */
.pb-safe-bottom {
  padding-bottom: max(1rem, env(safe-area-inset-bottom));
}

@supports (padding: max(0px)) {
  .safe-area-bottom {
    padding-bottom: max(1rem, env(safe-area-inset-bottom));
  }

  .safe-area-top {
    padding-top: max(1rem, env(safe-area-inset-top));
  }
}

/* Mobile navigation bar */
.mobile-nav {
  @apply fixed bottom-0 left-0 right-0 bg-white dark:bg-dark-800 border-t border-gray-200 dark:border-dark-700 z-50;
  padding-bottom: env(safe-area-inset-bottom, 0);
}

.mobile-nav-item {
  @apply flex flex-col items-center justify-center py-2 px-4 text-xs text-gray-600 dark:text-gray-400;
}

.mobile-nav-item.active {
  @apply text-primary-600 dark:text-primary-400;
}

.mobile-nav-item svg {
  @apply w-6 h-6 mb-1;
}

/* Swipe gesture hints */
.swipe-hint {
  @apply hidden;
}

@media (pointer: coarse) {
  .swipe-hint {
    @apply block text-xs text-gray-400 text-center py-2;
  }
}

/* Landscape mobile */
@media (max-height: 500px) and (orientation: landscape) {
  [role="dialog"]>div>div {
    max-height: 80vh;
  }

  .modal-content {
    max-height: 70vh;
    overflow-y: auto;
  }
}

/* Print styles */
@media print {
  .no-print {
    display: none !important;
  }

  .sidebar,
  .mobile-nav,
  .undo-redo-toolbar {
    display: none !important;
  }

  .main-content {
    margin-left: 0 !important;
  }
}